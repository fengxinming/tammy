/*!
 * tammy.js v1.0.0-beta.0
 * (c) 2018-2019 Jesse Feng
 * Released under the MIT License.
 */
var e,t;e=this,t=function(){"use strict";function m(e){return null==e}function c(e){return!m(e)&&"object"==typeof e}function p(e){return"string"==typeof e}function a(e,t){return t?e.bind(t):e}function d(e,t,n){return c(e)&&function(e,t,n){var o=a(t,n);for(var r in e)if(e.hasOwnProperty(r)&&!1===o(e[r],r,e))break}(e,t,n)}function l(e,t){e[e.length]=t}function h(e,t,n,o,r){for(var u=a(o,r),i=t,s=void 0;!1!==s&&i<n;i++)s=u(e[i],i,e)}function v(e,t){if(e)return l(e,t),t}function y(e,t,n){return c(e)&&function(e,t,n){var o=a(t,n);for(var r in e)if(!1===o(e[r],r,e))break}(e,t,n)}function r(e,t,n){return e&&function(e,t,n){h(e,0,e.length,t,n)}(e,t,n)}var T=/^(.*?):[ \t]*([^\r\n]*)$/gm,E=Object.assign||function(e){if(m(e))throw new TypeError("Cannot convert undefined or null to object");var n=Object(e);return r(arguments,function(e){y(e,function(e,t){n[t]=e})}),n};function H(o){for(var e=[],t=arguments.length-1;0<t--;)e[t]=arguments[t+1];function n(e,t){if(c(e)){var n=o[t];n=c(n)?n:{},o[t]=H(n,e)}else o[t]=e}return r(e,function(e){y(e,n)}),o}function g(e,t){var n=new Error(e);return E(n,t),n}function n(o,e){return e.forEach(function(e){var t=e.fulfilled,n=e.rejected;o=o.then(t,n)}),o}var q=console&&console.error||function(){},k={json:"application/json; charset=UTF-8",form:"application/x-www-form-urlencoded; charset=UTF-8",multipart:"multipart/form-data; charset=UTF-8"},t={"Content-Type":k.form},o={timeout:0,responseType:"json",xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&e<300||304===e}},w={common:{Accept:"application/json, text/plain, */*"}};["DELETE","GET","HEAD"].forEach(function(e){w[e]={}}),["POST","PUT","PATCH"].forEach(function(e){w[e]=E({},t)});var u={defaults:o,xhrHeaderHooks:[],reqHooks:[],resHooks:[],setHeader:function(e,t,n){return n=n?n.toUpperCase():"common","Content-Type"===e&&(t=k[t]||t),(w[n]||w.common)[e]=t,this}};function R(e){return"function"==typeof e}var x=u.xhrHeaderHooks;var i=u.reqHooks,s=u.resHooks;function f(e){var t,n=e.url,o=e.baseURL,r=e.headers,u=e.method,i=e.contentType,s=e.params,a=e.data,f=e.adapter;switch(o&&!function(e){return/^([a-z][a-z0-9+\-.]*:)?\/\//i.test(e)}(n)&&(n=e.url=function(e){var t=arguments,n=t.length;m(e)?1<n&&(e=""):e=e.replace(/\/+$/,"");var o="";return h(t,1,n,function(e){o+="/",o+=e||""}),o&&(e+=o.replace(/\/+/g,"/")),e}(o,n)),u=e.method=u?u.toUpperCase():"GET",r=e.headers=H({},w.common,w[u],r),(t=i&&k[i])&&(r["Content-Type"]=t),u){case"GET":s||(e.params=s=a,e.data=a=void 0);break;case"POST":t=r["Content-Type"]||"",c(a)&&(a=t.indexOf("application/json")?function(e){var n=[];return y(e,function(e,t){v(n,t+"="+e)}),n.join("&")}(a):JSON.stringify(a),e.data=a)}return c(s)&&(s=function(e,t,n){void 0===t&&(t="&"),void 0===n&&(n="=");var o=[];return d(e,function(e,t){e||!m(e)&&!isNaN(e)||(e=""),l(o,encodeURIComponent(t)+n+encodeURIComponent(e))}),o.length?o.join(t):""}(s)),p(s)&&(e.url=n+(-1<n.indexOf("?")?"?":"&")+s),f(e).then(function(e){var t=e.options,n=e.data;if("json"===t.responseType&&p(n))try{e.data=JSON.parse(n)}catch(e){q("parse data error: ",e)}return e})}o.adapter=function(h){return new Promise(function(r,u){var e=h.method,t=h.url,n=h.data,o=h.async,i=h.headers,s=h.timeout,a=h.responseType,f=h.onDownloadProgress,c=h.onUploadProgress,p=h.abortion,d=h.getAllResponseHeaders,l=new window.XMLHttpRequest;if(l.open(e,t,!1!==o),l.timeout=s||0,l.onreadystatechange=function(){if(l&&4===l.readyState){var e=l.status,t=l.responseURL,n=l.responseText;if(0!==e||t&&0===t.indexOf("file:")){var o={data:a&&"text"!==a?l.response||n:l,statusText:l.statusText,options:h,request:l,status:e};d&&"getAllResponseHeaders"in l&&(o.headers=function(e){for(var t,n={};t=T.exec(e);)n[t[1].toLowerCase()]=t[2];return n}(l.getAllResponseHeaders())),h.validateStatus(e)?r(o):u(g("Request failed with status code "+e,o)),l=null}}},l.onabort=function(){l&&(u(g("Request aborted",E({code:"ECONNABORTED",options:h,request:l},l.customError))),l=null)},l.onerror=function(){u(g("Network Error",{options:h,request:l})),l=null},l.ontimeout=function(){u(g("timeout of "+s+"ms exceeded",{code:"ECONNABORTED",options:h,request:l})),l=null},x.forEach(function(e){return e(h)}),"setRequestHeader"in l&&y(i,function(e,t){m(n)&&"Content-Type"===t?delete i[t]:l.setRequestHeader(t,e)}),h.withCredentials&&(l.withCredentials=!0),a)try{l.responseType=a}catch(e){q("responseType error: ",e)}R(f)&&l.addEventListener("progress",f),R(c)&&l.upload&&l.upload.addEventListener("progress",c),p&&p.add(function(e){l.customError=e,l.abort()}),l.send(n||null)})};var C=function(e){this.reqHooks=[],this.resHooks=[],this.options=e};C.prototype.hook=function(e,t,n){return v(this[e],{fulfilled:t,rejected:n}),this},C.prototype.request=function(e){e=E(H({},o),this.options,e);var t=Promise.resolve(e);return t=n(n(n(n(t,i),this.reqHooks).then(f),s),this.resHooks)};var b=function(){this.queue=[]};return b.prototype.abort=function(e){var t;e?c(e)&&(e=(t=e).message||""):e="Request aborted";for(var n,o=this.queue;n=o.shift();)n(g(e,t))},b.prototype.add=function(e){return v(this.queue,e),this},b.prototype.clear=function(){return this.queue.length=0,this},b.prototype.pipe=function(e){var t;if(e&&(t=e.queue))for(var n;n=t.shift();)v(t,n);return this},function t(e){var n=new C(e),r=function(e,t){return c(e)?e=(t=e).url:(t=t||{}).url=e,n.request(t)};return E(r,{Abortion:b,use:function(e){return e.installed||(e(u),e.installed=!0),r},hookRequest:function(e,t){return n.hook("reqHooks",e,t),r},hookResponse:function(e,t){return n.hook("resHooks",e,t),r},create:function(e){return t(e)},all:function(e){return Promise.all(e.map(function(e){return r(e)}))},map:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return r.all(e)}}),["get","delete","head","options","post","put","patch"].forEach(function(o){r[o]=function(e,t,n){return r(e,H({method:o,data:t},n))}}),r}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).tammy=t();